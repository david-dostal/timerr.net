{"version":3,"sources":["../../scripts/gui/timer-gui.js"],"names":["stopwatchElement","startButtonElement","resetButtonElement","formElement","hoursInput","minutesInput","secondsInput","timer","Timer","timerTick","timerCompleted","document","addEventListener","event","getElementById","localStorage","getItem","saveTimerTime","JSON","parse","h","m","s","reset","toMilliseconds","NumberInput","onclick","startClick","resetClick","updateUi","getTime","remaining","getState","TimerState","STOPPED","startTimer","PAUSED","resume","innerText","RUNNING","pause","inputsValid","freezeInputs","parseInt","value","start","setItem","stringify","unfreezeInputs","setTimeout","alert","millis","Math","round","decomposeTime","_","toString","padStart","valid","validity","reportValidity","setAttribute","removeAttribute"],"mappings":"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","file":"timer-gui.js","sourcesContent":["let stopwatchElement;\r\nlet startButtonElement;\r\nlet resetButtonElement;\r\nlet formElement;\r\n\r\nlet hoursInput;\r\nlet minutesInput;\r\nlet secondsInput;\r\n\r\nlet timer = new Timer(1000, timerTick, 2 * 60 * 1000, timerCompleted);\r\n\r\ndocument.addEventListener(\"DOMContentLoaded\", (event) => {\r\n    stopwatchElement = document.getElementById('timer-time');\r\n\r\n    hoursInput = document.getElementById('hours-input');\r\n    minutesInput = document.getElementById('minutes-input');\r\n    secondsInput = document.getElementById('seconds-input');\r\n    startButtonElement = document.getElementById('button-start');\r\n    resetButtonElement = document.getElementById('button-reset');\r\n    formElement = document.getElementById('timer-time');\r\n\r\n    if(localStorage && localStorage.getItem('timer-start-time') === null) {\r\n        saveTimerTime();\r\n    }\r\n    if(localStorage) {\r\n        let {h, m, s} = JSON.parse(localStorage.getItem('timer-start-time'));\r\n        timer.reset(toMilliseconds(h, m, s));\r\n    }\r\n\r\n    new NumberInput(hoursInput);\r\n    new NumberInput(minutesInput);\r\n    new NumberInput(secondsInput);\r\n\r\n    startButtonElement.onclick = startClick;\r\n    resetButtonElement.onclick = resetClick;\r\n\r\n    updateUi(timer.getTime());\r\n});\r\n\r\nfunction timerTick(remaining) {\r\n    //console.log(decomposeTime(remaining));\r\n    updateUi(remaining);\r\n}\r\n\r\nfunction startClick() {\r\n    switch (timer.getState()) {\r\n        case TimerState.STOPPED:\r\n            startTimer();\r\n            break;\r\n        case TimerState.PAUSED:\r\n            timer.resume();\r\n            startButtonElement.innerText = 'Pause';\r\n            break;\r\n        case TimerState.RUNNING:\r\n            timer.pause();\r\n            startButtonElement.innerText = 'Resume';\r\n            break;\r\n    }\r\n}\r\n\r\nfunction startTimer() {\r\n    if (inputsValid()) {\r\n        freezeInputs();\r\n        let [h, m, s] = [parseInt(hoursInput.value), parseInt(minutesInput.value), parseInt(secondsInput.value)];\r\n        saveTimerTime();\r\n        timer.start(toMilliseconds(h, m, s));\r\n        startButtonElement.innerText = 'Pause';\r\n    }\r\n}\r\n\r\nfunction saveTimerTime() {\r\n    if(localStorage) {\r\n        let [h, m, s] = [parseInt(hoursInput.value), parseInt(minutesInput.value), parseInt(secondsInput.value)];\r\n        localStorage.setItem('timer-start-time', JSON.stringify({h: h, m: m, s: s}));\r\n    }\r\n}\r\n\r\n\r\nfunction resetClick() {\r\n    timer.reset();\r\n    updateUi(timer.getTime());\r\n    startButtonElement.innerText = 'Start';\r\n    unfreezeInputs();\r\n}\r\n\r\nfunction timerCompleted() {\r\n    setTimeout(() => {\r\n        alert('Time is up!');\r\n        resetClick();\r\n    }, 1); // Timeout needed to give time to the browser to re-render before the alert is shown.\r\n}\r\n\r\nfunction updateUi(millis) {\r\n    //console.log(millis);\r\n    millis = Math.round(millis / 1000) * 1000;\r\n    let {h, m, s, _} = decomposeTime(millis);\r\n    hoursInput.value = h.toString().padStart(2, '0');\r\n    minutesInput.value = m.toString().padStart(2, '0');\r\n    secondsInput.value = s.toString().padStart(2, '0');\r\n}\r\n\r\nfunction inputsValid() {\r\n    let valid = hoursInput.validity.valid && minutesInput.validity.valid && secondsInput.validity.valid;\r\n    if (!valid) {\r\n        formElement.reportValidity();\r\n    }\r\n    return valid;\r\n}\r\n\r\nfunction freezeInputs() {\r\n    hoursInput.setAttribute('readonly', '');\r\n    minutesInput.setAttribute('readonly', '');\r\n    secondsInput.setAttribute('readonly', '');\r\n}\r\n\r\nfunction unfreezeInputs() {\r\n    hoursInput.removeAttribute('readonly');\r\n    minutesInput.removeAttribute('readonly');\r\n    secondsInput.removeAttribute('readonly');\r\n}"]}