{"version":3,"sources":["../../scripts/apps/alarm.js"],"names":["AlarmState","Object","freeze","ENABLED","DISABLED","Alarm","onFinished","targetTime","onRemainingUpdated","_targetTime","_state","_timerId","_remainingTimerId","disable","time","setTarget","setTimeout","_finished","remaining","setInterval","clearTimeout","Date","getTime"],"mappings":";;;;;;AAAA,IAAMA,aAAaC,OAAOC,MAAP,CAAc;AAC7BC,aAAS,SADoB;AAE7BC,cAAU;AAFmB,CAAd,CAAnB;;IAKMC,K;AACF,mBAAYC,UAAZ,EAAwBC,UAAxB,EAA+D;AAAA,YAA3BC,kBAA2B,uEAAN,IAAM;;AAAA;;AAC3D,aAAKF,UAAL,GAAkBA,UAAlB;AACA,aAAKG,WAAL,GAAmBF,UAAnB;AACA,aAAKC,kBAAL,GAA0BA,kBAA1B;AACA,aAAKE,MAAL,GAAcV,WAAWI,QAAzB;AACA,aAAKO,QAAL,GAAgB,IAAhB;AACA,aAAKC,iBAAL,GAAyB,IAAzB;AACH;;;;oCAGW;AACR,iBAAKC,OAAL;AACA,iBAAKP,UAAL;AACH;;;kCAESQ,I,EAAM;AACZ,iBAAKL,WAAL,GAAmBK,IAAnB;AACH;;;iCAE+B;AAAA;;AAAA,gBAAzBA,IAAyB,uEAAlB,KAAKL,WAAa;;AAC5B,gBAAI,KAAKC,MAAL,KAAgBV,WAAWI,QAA/B,EAAyC;AACrC,qBAAKM,MAAL,GAAcV,WAAWG,OAAzB;AACA,qBAAKY,SAAL,CAAeD,IAAf;AACA,qBAAKH,QAAL,GAAgBK,WAAW;AAAA,2BAAM,MAAKC,SAAL,EAAN;AAAA,iBAAX,EAAmC,KAAKC,SAAL,EAAnC,CAAhB;AACA,qBAAKV,kBAAL;AACA,qBAAKI,iBAAL,GAAyBO,YAAY;AAAA,2BAAM,MAAKX,kBAAL,EAAN;AAAA,iBAAZ,EAA6C,IAA7C,CAAzB;AACH;AACJ;;;kCAES;AACN,iBAAKE,MAAL,GAAcV,WAAWI,QAAzB;AACAgB,yBAAa,KAAKT,QAAlB;AACAS,yBAAa,KAAKR,iBAAlB;AACH;;;oCAEW;AACR,mBAAO,KAAKL,UAAL,KAAoB,IAAIc,IAAJ,GAAWC,OAAX,EAA3B;AACH;;;qCAEY;AACT,mBAAO,KAAKb,WAAZ;AACH;;;mCAEU;AACP,mBAAO,KAAKC,MAAZ;AACH","file":"alarm.js","sourcesContent":["const AlarmState = Object.freeze({\r\n    ENABLED: 'ENABLED',\r\n    DISABLED: 'DISABLED'\r\n});\r\n\r\nclass Alarm {\r\n    constructor(onFinished, targetTime, onRemainingUpdated = null) {\r\n        this.onFinished = onFinished;\r\n        this._targetTime = targetTime;\r\n        this.onRemainingUpdated = onRemainingUpdated;\r\n        this._state = AlarmState.DISABLED;\r\n        this._timerId = null;\r\n        this._remainingTimerId = null;\r\n    }\r\n\r\n\r\n    _finished() {\r\n        this.disable();\r\n        this.onFinished();\r\n    }\r\n\r\n    setTarget(time) {\r\n        this._targetTime = time;\r\n    }\r\n\r\n    enable(time = this._targetTime) {\r\n        if (this._state === AlarmState.DISABLED) {\r\n            this._state = AlarmState.ENABLED;\r\n            this.setTarget(time);\r\n            this._timerId = setTimeout(() => this._finished(), this.remaining());\r\n            this.onRemainingUpdated();\r\n            this._remainingTimerId = setInterval(() => this.onRemainingUpdated(), 1000);\r\n        }\r\n    }\r\n\r\n    disable() {\r\n        this._state = AlarmState.DISABLED;\r\n        clearTimeout(this._timerId);\r\n        clearTimeout(this._remainingTimerId);\r\n    }\r\n\r\n    remaining() {\r\n        return this.targetTime() - new Date().getTime();\r\n    }\r\n\r\n    targetTime() {\r\n        return this._targetTime;\r\n    }\r\n\r\n    getState() {\r\n        return this._state;\r\n    }\r\n}"]}