"use strict";var alarm=void 0;var enableButton=void 0;var hoursInput=void 0;var minutesInput=void 0;var remainingElement=void 0;var formElement=void 0;document.addEventListener("DOMContentLoaded",function(a){enableButton=document.getElementById("button-enable");hoursInput=document.getElementById("hours-input");minutesInput=document.getElementById("minutes-input");remainingElement=document.getElementById("remaining-time");formElement=document.getElementById("timer-time");if(!LocalStorage.hasValue("alarm-target-time")){saveAlarmTarget()}loadAlarmTarget();new NumberInput(hoursInput);new NumberInput(minutesInput);enableButton.onclick=enableClick;alarm=new Alarm(function(){return alarmFinished()},getInputTime(),function(){return updateRemaining()})});function alarmFinished(){alert("Beep Beep! It's "+new Date(alarm.targetTime()).toLocaleTimeString()+".");enableButton.innerText="Enable";unfreezeInputs()}function updateRemaining(){remainingElement.innerText=formatRemaining(alarm.remaining())}function formatRemaining(f){var g=Math.round(f/(1000*60))*1000*60;var c=decomposeTime(g),e=c.h,a=c.m,d=c.s,b=c.ms;return e+"h "+a+"m remaining"}function loadAlarmTarget(){if(LocalStorage.hasValue("alarm-target-time")){var c=LocalStorage.tryLoad("alarm-target-time"),b=c.h,a=c.m;hoursInput.value=b.toString().padStart(2,"0");minutesInput.value=a.toString().padStart(2,"0")}}function saveAlarmTarget(){var a={h:parseInt(hoursInput.value),m:parseInt(minutesInput.value)};LocalStorage.trySave("alarm-target-time",a)}function enableClick(){switch(alarm.getState()){case AlarmState.DISABLED:if(inputsValid()){freezeInputs();saveAlarmTarget();alarm.enable(getInputTime());enableButton.innerText="Disable alarm"}break;case AlarmState.ENABLED:alarm.disable();unfreezeInputs();enableButton.innerText="Enable alarm";remainingElement.innerText="";break}}function inputsValid(){var a=hoursInput.validity.valid&&minutesInput.validity.valid;if(!a){formElement.reportValidity()}return a}function getInputTime(){var e=parseInt(hoursInput.value);var a=parseInt(minutesInput.value);var c=new Date();var b=new Date(c.getFullYear(),c.getMonth(),c.getDate(),e,a,0);if(b.getTime()>c.getTime()){return b.getTime()}else{var d=24*60*60*1000;return b.getTime()+d}}function freezeInputs(){hoursInput.setAttribute("readonly","");minutesInput.setAttribute("readonly","")}function unfreezeInputs(){hoursInput.removeAttribute("readonly");minutesInput.removeAttribute("readonly")};