{"version":3,"sources":["alarm-gui.js"],"names":["alarm","enableButton","hoursInput","minutesInput","remainingElement","formElement","document","addEventListener","event","getElementById","LocalStorage","hasValue","saveAlarmTarget","loadAlarmTarget","NumberInput","onclick","enableClick","Alarm","alarmFinished","getInputTime","updateRemaining","alert","Date","targetTime","toLocaleTimeString","innerText","unfreezeInputs","formatRemaining","remaining","mins","Math","round","_decomposeTime","decomposeTime","h","m","s","ms","_LocalStorage$tryLoad","tryLoad","value","toString","padStart","time","parseInt","trySave","getState","AlarmState","DISABLED","inputsValid","freezeInputs","enable","ENABLED","disable","valid","validity","reportValidity","now","targetToday","getFullYear","getMonth","getDate","getTime","oneDay","setAttribute","removeAttribute"],"mappings":"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","file":"alarm-gui.js","sourcesContent":["'use strict';\n\nvar alarm = void 0;\nvar enableButton = void 0;\nvar hoursInput = void 0;\nvar minutesInput = void 0;\nvar remainingElement = void 0;\nvar formElement = void 0;\n\ndocument.addEventListener(\"DOMContentLoaded\", function (event) {\n    enableButton = document.getElementById('button-enable');\n    hoursInput = document.getElementById('hours-input');\n    minutesInput = document.getElementById('minutes-input');\n    remainingElement = document.getElementById('remaining-time');\n    formElement = document.getElementById('timer-time');\n\n    if (!LocalStorage.hasValue('alarm-target-time')) {\n        saveAlarmTarget();\n    }\n    loadAlarmTarget();\n\n    new NumberInput(hoursInput);\n    new NumberInput(minutesInput);\n\n    enableButton.onclick = enableClick;\n    alarm = new Alarm(function () {\n        return alarmFinished();\n    }, getInputTime(), function () {\n        return updateRemaining();\n    });\n});\n\nfunction alarmFinished() {\n    alert('Beep Beep! It\\'s ' + new Date(alarm.targetTime()).toLocaleTimeString() + '.');\n    enableButton.innerText = 'Enable';\n    unfreezeInputs();\n}\n\nfunction updateRemaining() {\n    remainingElement.innerText = formatRemaining(alarm.remaining());\n}\n\nfunction formatRemaining(remaining) {\n    var mins = Math.round(remaining / (1000 * 60)) * 1000 * 60;\n\n    var _decomposeTime = decomposeTime(mins),\n        h = _decomposeTime.h,\n        m = _decomposeTime.m,\n        s = _decomposeTime.s,\n        ms = _decomposeTime.ms;\n\n    return h + 'h ' + m + 'm remaining';\n}\n\nfunction loadAlarmTarget() {\n    if (LocalStorage.hasValue('alarm-target-time')) {\n        var _LocalStorage$tryLoad = LocalStorage.tryLoad('alarm-target-time'),\n            h = _LocalStorage$tryLoad.h,\n            m = _LocalStorage$tryLoad.m;\n\n        hoursInput.value = h.toString().padStart(2, '0');\n        minutesInput.value = m.toString().padStart(2, '0');\n    }\n}\n\nfunction saveAlarmTarget() {\n    var time = { h: parseInt(hoursInput.value), m: parseInt(minutesInput.value) };\n    LocalStorage.trySave('alarm-target-time', time);\n}\n\nfunction enableClick() {\n    switch (alarm.getState()) {\n        case AlarmState.DISABLED:\n            if (inputsValid()) {\n                freezeInputs();\n                saveAlarmTarget();\n                alarm.enable(getInputTime());\n                enableButton.innerText = 'Disable alarm';\n            }\n            break;\n        case AlarmState.ENABLED:\n            alarm.disable();\n            unfreezeInputs();\n            enableButton.innerText = 'Enable alarm';\n            remainingElement.innerText = '';\n            break;\n    }\n}\n\nfunction inputsValid() {\n    var valid = hoursInput.validity.valid && minutesInput.validity.valid;\n    if (!valid) {\n        formElement.reportValidity();\n    }\n    return valid;\n}\n\nfunction getInputTime() {\n    var h = parseInt(hoursInput.value);\n    var m = parseInt(minutesInput.value);\n    var now = new Date();\n    var targetToday = new Date(now.getFullYear(), now.getMonth(), now.getDate(), h, m, 0);\n    if (targetToday.getTime() > now.getTime()) {\n        return targetToday.getTime();\n    } else {\n        var oneDay = 24 * 60 * 60 * 1000;\n        return targetToday.getTime() + oneDay;\n    }\n}\n\nfunction freezeInputs() {\n    hoursInput.setAttribute('readonly', '');\n    minutesInput.setAttribute('readonly', '');\n}\n\nfunction unfreezeInputs() {\n    hoursInput.removeAttribute('readonly');\n    minutesInput.removeAttribute('readonly');\n}\n//# sourceMappingURL=alarm-gui.js.map"]}