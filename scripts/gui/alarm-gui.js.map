{"version":3,"sources":["alarm-gui.js"],"names":["alarm","enableButton","hoursInput","minutesInput","remainingElement","formElement","document","addEventListener","event","getElementById","localStorage","getItem","saveAlarmTarget","_JSON$parse","JSON","parse","h","m","value","toString","padStart","NumberInput","onclick","enableClick","Alarm","alarmFinished","getInputTime","updateRemaining","alert","Date","targetTime","toLocaleTimeString","innerText","unfreezeInputs","formatRemaining","remaining","mins","Math","round","_decomposeTime","decomposeTime","s","ms","_ref","parseInt","setItem","stringify","getState","AlarmState","DISABLED","inputsValid","freezeInputs","enable","ENABLED","disable","valid","validity","reportValidity","now","targetToday","getFullYear","getMonth","getDate","getTime","oneDay","setAttribute","removeAttribute"],"mappings":"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","file":"alarm-gui.js","sourcesContent":["'use strict';\n\nvar alarm = void 0;\nvar enableButton = void 0;\nvar hoursInput = void 0;\nvar minutesInput = void 0;\nvar remainingElement = void 0;\nvar formElement = void 0;\n\ndocument.addEventListener(\"DOMContentLoaded\", function (event) {\n    enableButton = document.getElementById('button-enable');\n    hoursInput = document.getElementById('hours-input');\n    minutesInput = document.getElementById('minutes-input');\n    remainingElement = document.getElementById('remaining-time');\n    formElement = document.getElementById('timer-time');\n\n    if (localStorage && localStorage.getItem('alarm-target-time') === null) {\n        saveAlarmTarget();\n    }\n    if (localStorage) {\n        var _JSON$parse = JSON.parse(localStorage.getItem('alarm-target-time')),\n            h = _JSON$parse.h,\n            m = _JSON$parse.m;\n\n        hoursInput.value = h.toString().padStart(2, '0');\n        minutesInput.value = m.toString().padStart(2, '0');\n    }\n\n    new NumberInput(hoursInput);\n    new NumberInput(minutesInput);\n\n    enableButton.onclick = enableClick;\n    alarm = new Alarm(function () {\n        return alarmFinished();\n    }, getInputTime(), function () {\n        return updateRemaining();\n    });\n});\n\nfunction alarmFinished() {\n    alert('Beep Beep! It\\'s ' + new Date(alarm.targetTime()).toLocaleTimeString() + '.');\n    enableButton.innerText = 'Enable';\n    unfreezeInputs();\n}\n\nfunction updateRemaining() {\n    remainingElement.innerText = formatRemaining(alarm.remaining());\n}\n\nfunction formatRemaining(remaining) {\n    var mins = Math.round(remaining / (1000 * 60)) * 1000 * 60;\n\n    var _decomposeTime = decomposeTime(mins),\n        h = _decomposeTime.h,\n        m = _decomposeTime.m,\n        s = _decomposeTime.s,\n        ms = _decomposeTime.ms;\n\n    return h + 'h ' + m + 'm remaining';\n}\n\nfunction saveAlarmTarget() {\n    if (localStorage) {\n        var _ref = [parseInt(hoursInput.value), parseInt(minutesInput.value)],\n            h = _ref[0],\n            m = _ref[1];\n\n        localStorage.setItem('alarm-target-time', JSON.stringify({ h: h, m: m }));\n    }\n}\n\nfunction enableClick() {\n    switch (alarm.getState()) {\n        case AlarmState.DISABLED:\n            if (inputsValid()) {\n                freezeInputs();\n                saveAlarmTarget();\n                alarm.enable(getInputTime());\n                enableButton.innerText = 'Disable alarm';\n            }\n            break;\n        case AlarmState.ENABLED:\n            alarm.disable();\n            unfreezeInputs();\n            enableButton.innerText = 'Enable alarm';\n            remainingElement.innerText = '';\n            break;\n    }\n}\n\nfunction inputsValid() {\n    var valid = hoursInput.validity.valid && minutesInput.validity.valid;\n    if (!valid) {\n        formElement.reportValidity();\n    }\n    return valid;\n}\n\nfunction getInputTime() {\n    var h = parseInt(hoursInput.value);\n    var m = parseInt(minutesInput.value);\n    var now = new Date();\n    var targetToday = new Date(now.getFullYear(), now.getMonth(), now.getDate(), h, m, 0);\n    if (targetToday.getTime() > now.getTime()) {\n        return targetToday.getTime();\n    } else {\n        var oneDay = 24 * 60 * 60 * 1000;\n        return targetToday.getTime() + oneDay;\n    }\n}\n\nfunction freezeInputs() {\n    hoursInput.setAttribute('readonly', '');\n    minutesInput.setAttribute('readonly', '');\n}\n\nfunction unfreezeInputs() {\n    hoursInput.removeAttribute('readonly');\n    minutesInput.removeAttribute('readonly');\n}\n//# sourceMappingURL=alarm-gui.js.map"]}